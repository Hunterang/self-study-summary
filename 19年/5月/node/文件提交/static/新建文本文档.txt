select c.*,sensor3d.netX,sensor3d.netY from(select DisplayName,SensorIndex,MeterType as type,SensorValue,(select Name from unit where Index0=unitValue) as unitstr,Flag,Message,max(Time) from (SELECT sensors.DisplayName,sensors.unit as unitValue,sensors.MeterType,b.* from (select * from (select * from record where Time>date_sub(now(),interval 5 MINUTE) order by Time desc)a where SensorIndex in(SELECT SensorNo FROM `class` where Parent=(select ID from class where Name='snmp1') and Detail is NULL) group by SensorIndex)b left join sensors on b.SensorIndex=sensors.No where SensorIndex in (SELECT SensorNo FROM `class` where Parent=(select ID from class where Name='snmp1') and Detail is NULL) order by Time desc limit 1000)a group by SensorIndex)c left join sensor3d on c.SensorIndex=sensor3d.SensorIndex"